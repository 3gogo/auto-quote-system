# 大模型功能评估报告

> 评估时间: 2025-12-26  
> 模型: bailu-2.6-fast-thinking  
> API: https://bailucode.com/openapi/v1

---

## 一、评估概述

本报告对系统中集成的大模型 NLU 能力进行全面评估，包含两种测试模式：

| 测试模式 | 说明 | 测试用例 | 通过率 |
|---------|------|---------|-------|
| **混合模式** | 规则层优先，低置信度时调用大模型 | 34 | **82.4%** |
| **强制 AI 模式** | 绕过规则层，直接测试大模型 | 30 | **90.0%** |

---

## 二、强制 AI 模式评估（绕过规则层）

### 2.1 总体指标

| 指标 | 数值 |
|------|------|
| 总测试数 | 30 |
| 通过 | 27 |
| 失败 | 3 |
| **通过率** | **90.0%** |
| **意图识别准确率** | **90.0%** |
| 平均响应时间 | 3632ms |

### 2.2 各场景评估

| 场景分类 | 通过率 | 说明 |
|---------|-------|------|
| 核心-报价 | ✅ 100% (3/3) | 标准报价场景完美支持 |
| 核心-查价 | ✅ 100% (3/3) | 单品查价识别准确 |
| 核心-修正 | ✅ 100% (4/4) | 价格修正全部正确 |
| 核心-确认 | ⚠️ 67% (2/3) | "行" 被误判为 unknown |
| 核心-取消 | ✅ 100% (3/3) | 取消意图识别完美 |
| 核心-进货 | ✅ 100% (2/2) | 进货查价正确识别 |
| 难点-口语 | ✅ 100% (3/3) | **口语化表达处理优秀** |
| 难点-模糊 | ✅ 100% (2/2) | **模糊描述理解良好** |
| 难点-复杂 | ✅ 100% (2/2) | **复杂句式处理优秀** |
| 难点-数量 | ⚠️ 50% (1/2) | "一箱矿泉水" 误判为查价 |
| 边界 | ⚠️ 67% (2/3) | 特殊字符处理有偏差 |

### 2.3 失败用例分析

| 用例 | 输入 | 期望 | 实际 | 分析 |
|-----|------|-----|------|------|
| 确认-行 | "行" | confirm | unknown | 单字表达语义不足 |
| 数量-一箱 | "一箱矿泉水" | retail_quote | single_item_query | 无询价词，存在歧义 |
| 边界-特殊字符 | "可乐！！！多少钱？？？" | retail_quote | single_item_query | "多少钱"触发查价 |

### 2.4 大模型优势场景

**✅ 大模型在以下场景表现优秀（规则层难以处理）：**

1. **口语化表达**
   - "给俺整两包烟" → 正确识别报价意图 + 商品"烟"
   - "帮我弄一箱矿泉水" → 正确识别报价意图

2. **模糊描述**
   - "那个红色的饮料来两瓶" → 识别为"红色的饮料"
   - "那个啥，就是上次买的那个" → 识别为报价意图

3. **复杂句式**
   - "张三昨天说要来买东西今天终于来了帮他拿两瓶可乐" → 正确提取顾客"张三"和商品"可乐"

4. **进货场景**
   - "批发商那里雪碧什么价" → 正确识别 purchase_price_check

---

## 三、混合模式评估（规则层 + 大模型）

### 3.1 总体指标

| 指标 | 数值 |
|------|------|
| 总测试数 | 34 |
| 通过 | 28 |
| 失败 | 6 |
| **通过率** | **82.4%** |
| 规则层处理比例 | 76% |
| 大模型处理比例 | 24% |
| 规则层平均耗时 | 5ms |
| 大模型平均耗时 | 3.6s |

### 3.2 性能分析

| 指标 | 数值 |
|------|------|
| 快速响应 (<1s) | 76% |
| 慢响应 (>5s) | 12% |
| 平均响应时间 | 1246ms |

### 3.3 规则层 vs 大模型对比

| 场景 | 规则层表现 | 大模型表现 | 推荐 |
|-----|----------|----------|-----|
| 标准报价 | ✅ 优秀 | ✅ 优秀 | 规则层 (5ms) |
| 单品查价 | ✅ 良好 | ✅ 优秀 | 规则层 |
| 价格修正 | ✅ 优秀 | ✅ 优秀 | 规则层 |
| 确认/取消 | ⚠️ 部分问题 | ✅ 良好 | 混合 |
| 口语表达 | ⚠️ 部分问题 | ✅ 优秀 | **大模型** |
| 模糊描述 | ⚠️ 难处理 | ✅ 优秀 | **大模型** |
| 复杂句式 | ⚠️ 难处理 | ✅ 优秀 | **大模型** |

---

## 四、综合评估结论

### 4.1 评分

| 维度 | 评分 | 说明 |
|------|------|------|
| **意图识别** | ⭐⭐⭐⭐⭐ (90%) | 核心意图识别准确 |
| **实体提取** | ⭐⭐⭐⭐ (85%) | 顾客/商品提取良好 |
| **口语理解** | ⭐⭐⭐⭐⭐ (100%) | 方言/口语处理优秀 |
| **模糊理解** | ⭐⭐⭐⭐⭐ (100%) | 模糊描述理解出色 |
| **响应速度** | ⭐⭐⭐⭐ (3.6s) | 可接受，建议优化 |
| **稳定性** | ⭐⭐⭐⭐ | JSON 格式输出稳定 |

### 4.2 总评

```
┌────────────────────────────────────────────┐
│                                            │
│   大模型 NLU 能力评估: ⭐⭐⭐⭐ (4.5/5)      │
│                                            │
│   ✅ 优秀：大模型意图识别能力强，可作为     │
│      规则层的可靠兜底，尤其在口语化表达、   │
│      模糊描述、复杂句式等场景表现出色。     │
│                                            │
└────────────────────────────────────────────┘
```

### 4.3 系统整体架构评估

```
┌─────────────────────────────────────────────────────────┐
│                     请求处理流程                         │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  用户输入 → [规则层] → 置信度 > 0.6? → 返回结果         │
│                │                                        │
│                └──── 置信度 ≤ 0.6 ────→ [大模型层]      │
│                                              │          │
│                                              ↓          │
│                                         合并结果        │
│                                                         │
├─────────────────────────────────────────────────────────┤
│  规则层: 处理 76% 请求, 平均 5ms                         │
│  大模型层: 处理 24% 请求, 平均 3.6s                      │
│  整体平均: 1.2s                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 五、优化建议

### 5.1 规则层优化

| 问题 | 当前表现 | 建议 |
|-----|---------|------|
| "算了不买了" 误判 | retail_quote | 添加"算了"到 deny 规则 |
| "可乐多少钱一瓶" 误判 | retail_quote | 优化 single_item_query 规则 |
| "批发商那里" 未识别 | single_item_query | 添加"批发商"到进货关键词 |

### 5.2 大模型优化

| 问题 | 当前表现 | 建议 |
|-----|---------|------|
| "行" 误判为 unknown | 置信度 0.5 | 在提示词中强调单字确认 |
| "一箱矿泉水" 歧义 | single_item_query | 增加上下文判断逻辑 |

### 5.3 性能优化

1. **缓存常见表达**：对高频表达结果进行缓存
2. **异步预热**：预加载模型连接
3. **模型选择**：考虑使用更快的模型（如 deepseek-v3）

---

## 六、测试脚本

```bash
# 混合模式测试（规则层 + 大模型）
npm run test:llm-full

# 强制 AI 模式测试（仅大模型）
npm run test:llm-only
```

---

## 附录：测试用例清单

<details>
<summary>点击展开完整测试用例</summary>

### 核心场景
- 标准报价-完整: "张三两瓶可乐三包纸巾多少钱"
- 标准报价-简洁: "老王要五瓶啤酒"
- 标准报价-无顾客: "两瓶矿泉水多少钱"
- 单品查价-多少钱: "可乐多少钱一瓶"
- 单品查价-怎么卖: "纸巾怎么卖"
- 单品查价-什么价: "啤酒什么价"
- 价格修正-固定价: "按10块算"
- 价格修正-便宜: "便宜点"
- 价格修正-抹零: "抹个零头"
- 价格修正-打折: "给打个九折"
- 确认-好的: "好的"
- 确认-成交: "成交"
- 确认-行: "行"
- 取消-不要了: "不要了"
- 取消-算了: "算了不买了"
- 取消-重来: "不对，重新来"
- 进货-老李: "老李那边可乐进价多少"
- 进货-批发商: "批发商那里雪碧什么价"

### 难点场景
- 口语-给我来: "给我来三瓶可乐"
- 口语-方言俺: "给俺整两包烟"
- 口语-帮我弄: "帮我弄一箱矿泉水"
- 模糊-红色饮料: "那个红色的饮料来两瓶"
- 模糊-那个啥: "那个啥，就是上次买的那个"
- 复杂-长句: "张三昨天说要来买东西今天终于来了帮他拿两瓶可乐"
- 复杂-熟客老规矩: "张三老规矩"
- 数量-半斤: "来半斤瓜子"
- 数量-一箱: "一箱矿泉水"

### 边界场景
- 边界-问候: "你好"
- 边界-无关问题: "今天天气怎么样"
- 边界-特殊字符: "可乐！！！多少钱？？？"

</details>

